train:
  eval_additional_task:
    EvaluationTask:
      _target_: "trax.learning.trainer.EvaluationTask"
      labeled_data: "${data.eval_additional_task.make_additional_stream}"
      metrics:
        - "${train.WeightedCategoryAccuracy}"
        - "${train.SequenceAccuracy}"
      metric_names:
        - "Full program accuracy"
        - "Full program sequence accuracy"
  WeightedCategoryAccuracy:
    _target_: "trax.layers.WeightedCategoryAccuracy"
  SequenceAccuracy:
    _target_: "trax.layers.SequenceAccuracy"
  train:
    optimizer: "${optim.Adafactor}"
    eval_frequency: 20
    eval_steps: 10
    inputs: "${data.make_streams}"
    model: "${model.ConfigurableTransformer}"
    steps: 200000
    additional_eval_tasks:
      - "${train.eval_additional_task.EvaluationTask}"
    additional_train_tasks:
      - "${data.train_rationale_task.TrainingTask}"
      - "${data.train_category_task.TrainingTask}"
