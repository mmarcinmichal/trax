train:
  eval_basic_task:
    EvaluationTask:
      _target_: "trax.learning.trainer.EvaluationTask"
      labeled_data: "${data.eval_basic_task.make_additional_stream}"
      metrics:
        - "${train.WeightedCategoryAccuracy}"
        - "${train.SequenceAccuracy}"
      metric_names:
        - "Single instruction accuracy"
        - "Single instruction sequence accuracy"
  eval_rationale_task:
    EvaluationTask:
      _target_: "trax.learning.trainer.EvaluationTask"
      labeled_data: "${data.eval_rationale_task.make_additional_stream}"
      metrics:
        - "${train.WeightedCategoryAccuracy}"
        - "${train.SequenceAccuracy}"
      metric_names:
        - "Rationale accuracy"
        - "Rationale sequence accuracy"
  eval_category_task:
    EvaluationTask:
      _target_: "trax.learning.trainer.EvaluationTask"
      labeled_data: "${data.eval_category_task.make_additional_stream}"
      metrics:
        - "${train.WeightedCategoryAccuracy}"
        - "${train.SequenceAccuracy}"
      metric_names:
        - "Category accuracy"
        - "Category sequence accuracy"
  eval_full_inference:
    EvaluationTask:
      _target_: "trax.learning.trainer.EvaluationTask"
      labeled_data: "${data.eval_full_inference.make_additional_stream}"
      metrics:
        - "${train.WeightedCategoryAccuracy}"
        - "${train.SequenceAccuracy}"
      metric_names:
        - "Full program accuracy"
        - "Full program sequence accuracy"
  WeightedCategoryAccuracy:
    _target_: "trax.layers.WeightedCategoryAccuracy"
  SequenceAccuracy:
    _target_: "trax.layers.SequenceAccuracy"
  train:
    optimizer: "${optim.Adafactor}"
    eval_frequency: 20
    eval_steps: 10
    inputs: "${data.make_inputs}"
    model: "${model.ConfigurableTransformer}"
    steps: 200000
    additional_eval_tasks:
      - "${train.eval_basic_task.EvaluationTask}"
      - "${train.eval_rationale_task.EvaluationTask}"
      - "${train.eval_category_task.EvaluationTask}"
      - "${train.eval_full_inference.EvaluationTask}"
