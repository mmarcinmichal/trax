defaults:
  - /data/base
  - _self_

data:
  make_streams:
    _target_: "trax.data.make_streams"
    _partial_: true
    train_stream:
      - "${data.train.TFDS}"
      - "${data.GenericTextPreprocess}"
      - "${data.Shuffle}"
      - "${data.train.BucketByLength}"
      - "${data.AddLossWeights}"
    eval_stream:
      - "${data.eval.TFDS}"
      - "${data.GenericTextPreprocess}"
      - "${data.Shuffle}"
      - "${data.eval.BucketByLength}"
      - "${data.AddLossWeights}"
  train:
    TFDS:
      _target_: "trax.data.TFDS"
      dataset_name: "squad/plain_text:1.0.0"
      data_dir: null
      train: true
    BucketByLength:
      _target_: "trax.data.BucketByLengthFromBatcher"
      training: true
      buckets:
        - - 513
        - - 8
          - 8
      strict_pad_on_len: true
      buckets_include_inputs_in_length: true
  eval:
    TFDS:
      _target_: "trax.data.TFDS"
      dataset_name: "squad/plain_text:1.0.0"
      data_dir: null
      train: false
    BucketByLength:
      _target_: "trax.data.BucketByLengthFromBatcher"
      training: false
      buckets:
        - - 513
        - - 8
          - 8
      strict_pad_on_len: true
      buckets_include_inputs_in_length: true
  AddLossWeights:
    _target_: "trax.data.add_loss_weights"
    _partial_: true
  GenericTextPreprocess:
    _target_: "trax.data.GenericTextPreprocess"
    _partial_: true
    spm_path: "gs://t5-data/vocabs/cc_all.32000/sentencepiece.model"
    text_preprocess_fns:
      - "${data.SquadTextPreprocess}"
    token_preprocess_fns:
      - "${data.AddEOS}"
  SquadTextPreprocess:
    _target_: "trax.data.SquadTextPreprocess"
    _partial_: true
    include_context: true
  AddEOS:
    _target_: "trax.data.AddEOS"
    _partial_: true
