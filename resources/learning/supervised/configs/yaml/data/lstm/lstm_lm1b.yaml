defaults:
  - /data/base
  - _self_

data:
  make_streams:
    _target_: "trax.data.make_streams"
    _partial_: true
    train_stream:
      - "${data.train.TFDS}"
      - "${data.DictToTupleInputsTargets}"
      - "${data.train.LM1BFilterByLength}"
      - "${data.Shuffle}"
      - "${data.train.BucketByLength}"
      - "${data.AddLossWeights}"
    eval_stream:
      - "${data.eval.TFDS}"
      - "${data.DictToTupleInputsTargets}"
      - "${data.eval.LM1BFilterByLength}"
      - "${data.Shuffle}"
      - "${data.eval.BucketByLength}"
      - "${data.AddLossWeights}"
  train:
    TFDS:
      _target_: "trax.data.TFDS"
      dataset_name: "t2t_languagemodel_lm1b32k"
      data_dir: null
      train: true
    LM1BFilterByLength:
      _target_: "trax.data.LM1BFilterByLength"
      training: true
      max_target_length: 512
      max_eval_target_length: 2048
    BucketByLength:
      _target_: "trax.data.BucketByLengthFromBatcher"
      training: true
      batch_size_per_device: 64
      eval_batch_size: 64
      max_eval_length: 2048
  eval:
    TFDS:
      _target_: "trax.data.TFDS"
      dataset_name: "t2t_languagemodel_lm1b32k"
      data_dir: null
      train: false
    LM1BFilterByLength:
      _target_: "trax.data.LM1BFilterByLength"
      training: false
      max_target_length: 512
      max_eval_target_length: 2048
    BucketByLength:
      _target_: "trax.data.BucketByLengthFromBatcher"
      training: false
      batch_size_per_device: 64
      eval_batch_size: 64
      max_eval_length: 2048
  AddLossWeights:
    _target_: "trax.data.add_loss_weights"
    _partial_: true
    id_to_mask: 0
  DictToTupleInputsTargets:
    _target_: "trax.data.DictToTuple"
    keys:
      - "inputs"
      - "targets"
